:root {
  --popup-bg: light-dark(#ffffff, #42414d);
  --popup-border: light-dark(#cfcfd8, #52525e);
  --popup-shadow: light-dark(rgba(0, 0, 0, 0.15), rgba(0, 0, 0, 0.3));

  --filename-text: light-dark(#15141a, #fbfbfe);
  --filename-bg: light-dark(#f0f0f4, #1c1b22);
  --filename-focus-ring: #0061e0;

  --preview-bg: light-dark(rgba(0, 0, 0, 0.05), transparent);
  --preview-text-bg: light-dark(transparent, #2b2a33);
  --preview-text-color: light-dark(#15141a, #fbfbfe);
  --preview-focus-ring: light-dark(#0061e0, #00ddff);

  --toggle-text: light-dark(#15141a, #ffffff);
  --toggle-bg: light-dark(rgba(21, 20, 26, 0.07), #3c3c3c);
  --toggle-bg-hover: light-dark(rgba(21, 20, 26, 0.14), #5a5a5a);

  --button-bg: light-dark(#0061e0, #00ddff);
  --button-hover: color-mix(in srgb, black 10%, var(--button-bg));
  --button-active: color-mix(in srgb, black 20%, var(--button-bg));
  --button-text: light-dark(#ffffff, #1c1b22);
}

* {
  box-sizing: border-box;
}

html,
body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
  font: menu;
  background: transparent;
  text-rendering: optimizeLegibility;

  &:focus {
    outline: none;
  }
}

button {
  padding-block: 0;
  font: inherit;
  border: none;
  border-radius: calc(4px / var(--devicePixelRatio));
  outline-offset: calc(2px / var(--devicePixelRatio));
}

#popup {
  position: fixed;
  display: flex;
  flex-flow: column;
  width: calc(300px / var(--devicePixelRatio));
  height: calc(250px / var(--devicePixelRatio));
  padding: calc(8px / var(--devicePixelRatio));
  opacity: 0;
  background-color: var(--popup-bg);
  border: calc(1px / var(--devicePixelRatio)) var(--popup-border) solid;
  border-radius: calc(8px / var(--devicePixelRatio));
  box-shadow: 0 calc(4px / var(--devicePixelRatio))
    calc(16px / var(--devicePixelRatio)) 0 var(--popup-shadow);
  color-scheme: light;

  &[prefersDark] {
    color-scheme: dark;
  }

  &[data-format="png"] {
    #basename::after {
      content: ".png";
    }

    #formatToggle span::after,
    #floatingFormatToggle span::after {
      content: "PNG";
    }
  }

  &[data-format="jpeg"] {
    #basename::after {
      content: ".jpg";
    }

    #formatToggle span::after,
    #floatingFormatToggle span::after {
      content: "JPG";
    }
  }
}

#preview {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  padding: 0;
  overflow: hidden;
  background-color: var(--preview-bg);
  border-radius: calc(4px / var(--devicePixelRatio));

  #imagePreview {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  #textPreview {
    width: 100%;
    height: 100%;
    padding: calc(8px / var(--devicePixelRatio));
    overflow: auto;
    font-size: calc(12px / var(--devicePixelRatio));
    color: var(--preview-text-color);
    text-align: left;
    white-space: pre;
    word-break: normal;
    user-select: none;
    background-color: var(--preview-text-bg);
  }

  &:is(:hover, :focus-within) {
    outline: calc(2px / var(--devicePixelRatio)) solid var(--preview-focus-ring);
  }

  &:focus {
    outline: calc(2px / var(--devicePixelRatio)) solid
      color-mix(in srgb, black 10%, var(--preview-focus-ring));
  }
}

#filenameContainer {
  display: flex;
  flex: 0 0 auto;
  align-items: center;
  min-height: calc(24px / var(--devicePixelRatio));
  margin-bottom: calc(10px / var(--devicePixelRatio));
  padding-block: calc(6px / var(--devicePixelRatio));
  padding-inline: calc(8px / var(--devicePixelRatio));
  overflow: hidden;
  cursor: text;
  background-color: var(--filename-bg);
  border: calc(1px / var(--devicePixelRatio)) solid transparent;
  border-radius: calc(4px / var(--devicePixelRatio));

  &[hidden] {
    display: none !important;
  }

  &:has(#filename:focus-within) {
    border-color: var(--filename-focus-ring);
    outline: calc(2px / var(--devicePixelRatio)) solid
      var(--filename-focus-ring);
    outline-offset: calc(-1px / var(--devicePixelRatio));
  }

  #filename {
    display: flex;
    flex: 1 1 auto;
    align-items: center;
    min-width: 0;

    #basename {
      display: inline-block;
      flex: 1 1 auto;
      overflow: scroll;
      font-family: inherit;
      font-size: calc(14px / var(--devicePixelRatio));
      white-space: nowrap;
      color: var(--filename-text);
      outline: none;
      scrollbar-width: none;
      overscroll-behavior: none;

      &::after {
        color: inherit;
        opacity: 0.5;
        pointer-events: none;
      }

      &:not(:focus)::selection {
        background: transparent;
      }

      &.empty {
        &::before {
          content: attr(data-placeholder);
          color: inherit;
          font-family: inherit;
          opacity: 0.5;
          pointer-events: none;
        }

        & > br {
          display: none;
        }
      }
    }
  }
}

#formatToggle,
#floatingFormatToggle {
  display: flex;
  flex: 0 0 auto;
  justify-content: center;
  padding-block: calc(4px / var(--devicePixelRatio));
  padding-inline: calc(8px / var(--devicePixelRatio));
  font-family: inherit;
  font-weight: 600;
  color: var(--toggle-text);
  text-transform: uppercase;
  box-shadow: 0 0 calc(4px / var(--devicePixelRatio))
    light-dark(transparent, rgba(0, 0, 0, 0.5));

  span {
    pointer-events: none;
  }

  &[hidden] {
    display: none !important;
  }

  &:focus-visible {
    outline: calc(2px / var(--devicePixelRatio)) solid var(--button-bg);
    outline-offset: 0px;
  }
}

#formatToggle {
  margin-inline-start: calc(6px / var(--devicePixelRatio));
  font-size: calc(12px / var(--devicePixelRatio));
  line-height: calc(14px / var(--devicePixelRatio));
  background-color: var(--toggle-bg);
  border-radius: calc(4px / var(--devicePixelRatio));

  &:hover {
    background-color: var(--toggle-bg-hover);
  }
}

#floatingFormatToggle {
  position: absolute;
  top: calc(12px / var(--devicePixelRatio));
  right: calc(12px / var(--devicePixelRatio));
  font-size: calc(13px / var(--devicePixelRatio));
  line-height: calc(20px / var(--devicePixelRatio));
  background-color: light-dark(#ffffff, #1c1b22);
  border: calc(1px / var(--devicePixelRatio)) solid
    light-dark(var(--popup-border), #1c1b22);
  border-radius: calc(4px / var(--devicePixelRatio));

  &::after {
    content: "";
    position: absolute;
    inset: calc(-6px / var(--devicePixelRatio));
  }

  &:hover {
    background-color: light-dark(#e6e6e6, #2b2a33);
    border-color: light-dark(var(--popup-border), #2b2a33);
  }
}

#showAllFiles {
  min-height: calc(32px / var(--devicePixelRatio));
  margin-top: calc(10px / var(--devicePixelRatio));
  font-family: inherit;
  font-size: calc(14px / var(--devicePixelRatio));
  font-weight: 600;
  color: var(--button-text);
  background-color: var(--button-bg);

  &:hover {
    background-color: var(--button-hover);
  }

  &:active {
    background-color: var(--button-active);
  }

  &:focus-visible {
    outline: calc(2px / var(--devicePixelRatio)) solid var(--button-bg);
    outline-offset: calc(2px / var(--devicePixelRatio));
  }
}
